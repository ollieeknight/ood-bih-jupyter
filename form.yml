---
cluster: "research"
form:
  - python_provider
  - conda_path
  - apptainer_image
  - jupyter_kind
  - work_dir
  - bih_cpus
  - bih_mem
  - bih_time
  - bih_partition
attributes:
  jupyter_kind:
    widget: "select"
    label: "Jupyter Lab/Notebook"
    options:
      - [ "Jupyter Lab", "lab" ]
      - [ "Jupyter Notebook", "notebook" ]
    help: |
      Choose between the modern Jupyter Lab interface or the legacy Jupyter Notebook.
  python_provider:
    widget: "select"
    label: "Python environment source"
    help: |
      You can either use one of the provided Apptainer images
      or provide a path to your own Conda installation.
    options:
      - [ "Apptainer", "apptainer", data-hide-conda-path: true, data-set-conda-path: "hidden" ]
      - [ "Conda environment", "miniconda", data-hide-apptainer-image: true, data-set-conda-path: "" ]
  conda_path:
    widget: "text_field"
    label: "Path to conda environment"
    help: |
      Specify the full path to your Miniforge3 installation's 'bin' directory,
      followed by a colon and the name of your Python environment.
      Example: `~/work/bin/miniforge3/bin:fancy-jupyter`
    required: true
  work_dir:
    widget: "text_field"
    label: "Working directory"
    help: |
      Specify the path to the working directory.
      If you leave this blank, you will start in your `$HOME` directory.
  apptainer_image:
    widget: "select"
    label: "Jupyter server version"
    help: |
      The Apptainer images are based on the miniconda3 Docker image
      and include Jupyter notebook, scikit-learn, pandas, and other
      popular scientific Python packages.
    options:
      - [ "BIH Jupyter 0.3", "bih-jupyter-0.3" ]
  bih_cpus:
    widget: "number_field"
    label: "Number of CPU cores"
    value: 8
    min: 1
    max: 64
    step: 1
    help: "Allocate the number of CPU cores for your Jupyter server"
  bih_mem:
    widget: "number_field"
    label: "Memory (in GB)"
    value: 32
    min: 1
    max: 256
    help: "Specify the amount of RAM (in gigabytes) for your Jupyter session"
  bih_time:
    widget: "text_field"
    label: "Job running time"
    value: "12h"
    required: true
    help: |
      Define the maximum duration for your Jupyter server session.
      Use 'h' for hours (e.g., '12h') or 'd' for days (e.g., '3d').
      Maximum allowed: 14 days.
    pattern: "^([0-9]{1,2}h|[1-9]d|1[0-4]d)$"
  bih_partition:
    widget: select
    label: "HPC partition"
    value: "medium"
    help: |
      - **medium**: Up to 7 days runtime, with a maximum of 128 cores across all your jobs.
      - **long**: Up to 28 days runtime, with a maximum of 32 cores across all your jobs.
      - **gpu**: GPU partition for GPU-accelerated computing.
    options:
      - [ "Medium (Max 7 days, 128 cores)", "medium" ]
      - [ "Long (Max 28 days, 32 cores)", "long" ]
      - [ "GPU (GPU-accelerated computing)", "gpu" ]